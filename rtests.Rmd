```{r test matrix generation}

oldest_migration_matrix <- function(num_populations){
  oldest_matrix <- paste("//Migration matrix", num_populations - 1)
  temp <- matrix(rep("0", num_populations^2), ncol = num_populations)
  oldest_matrix <- c(oldest_matrix, apply(temp, 1, paste, collapse = " "))
  return(oldest_matrix)
}

current_migration_matrix <- function(num_populations, ...){
  current_matrix <- 
    c("//Migration matrix 0")
  for(i in 1:num_populations){
    matrix_row <- c()
    for(j in 1:num_populations){
      if(i == j) mij <- "0"
      else{
        from <- population_name(index = j-1, ...)
        to <- population_name(index = i-1, ...)
        mij <- paste("MIG_", from, "to", to, sep = "")
      }
      matrix_row <- c(matrix_row, mij)
    }
    current_matrix <- c(current_matrix, paste(matrix_row, collapse = " "))
  }
  return(current_matrix)
}

matrix_generation <- function(num_pops, divergence_events, ...){
  subsequent_matrix <- current_migration_matrix(num_populations = num_pops, ...)
  output <- subsequent_matrix
  # Loop through all the divbergence events to create matrices going backward in time
  for(i in rev(seq_along(divergence_events))){
    event <- divergence_events[i]
    subsequent_matrix_index <- gsub("T.* ([0-9])$", "\\1", event)
    if(subsequent_matrix_index == (num_pops - 1) ) subsequent_matrix <- oldest_migration_matrix(num_pops)
    else{ 
      coalescing_population <- gsub("^TDIV_[a-zA-Z]*to([a-zA-Z]*) [0-9].*$", "\\1", event)
      subsequent_matrix <- 
        gsub(
          paste0("MIG_", coalescing_population, "to[A-Z]*|", "MIG_[A-Z]*to", coalescing_population), 
          "0", 
          subsequent_matrix[-1]
        )
      subsequent_matrix <- 
        c(
          paste("//Migration matrix", subsequent_matrix_index), 
          subsequent_matrix
        )
    }
    output <- c(output, subsequent_matrix)
  }
  return(output)
}

population_name <- function(index) {
    if (index == 0) {
        return("RAYA")
    }
    else {
        return("TREVOR")
    }
}

output <- matrix_generation()
```

```{r randomize divergence order}
my_sample <- function(x, ...){
  if(length(x) == 1) return(x)
  else sample(x, ...)
}

possible_roots = c(1,5,6,7,9)
root <- my_sample(possible_roots, size = 1)
root
class(root)

# root2 <- sample(possible_roots, 1)
# root2
```